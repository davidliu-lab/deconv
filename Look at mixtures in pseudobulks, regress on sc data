{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "1707513d",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "89e1f475",
   "metadata": {},
   "source": [
    "# read single cells"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "11346ccd",
   "metadata": {},
   "outputs": [],
   "source": [
    "columns = pd.read_csv(\n",
    "    filepath_or_buffer='./data/ftp/GSE115978/GSE115978_tpm.csv',\n",
    "    nrows=1,\n",
    "    index_col=0\n",
    ").columns\n",
    "\n",
    "dtypes = {col: np.float16 for col in columns}\n",
    "dtypes['GENE'] = str"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "b3a7a204",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_tpm = pd.read_csv(\n",
    "    filepath_or_buffer='./data/ftp/GSE115978/GSE115978_tpm.csv',\n",
    "#     nrows=10000,\n",
    "    dtype=dtypes,\n",
    "    index_col=0\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d920e2a8",
   "metadata": {},
   "source": [
    "# read Derek's pseudobulks"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "297bb708",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[01;34m./data/dropbox/Dave Liu Lab\u001b[00m\n",
      "└── [4.0K]  \u001b[01;34mDerek\u001b[00m\n",
      "    ├── [4.0K]  \u001b[01;34mscRNAseq\u001b[00m\n",
      "    │   └── [4.0K]  \u001b[01;34mmelanoma\u001b[00m\n",
      "    │       ├── [2.5M]  metadata_all.txt\n",
      "    │       ├── [805M]  tumors_norm_counts.txt\n",
      "    │       └── [805M]  tumors_tpm.txt\n",
      "    └── [4.0K]  \u001b[01;34msimulations\u001b[00m\n",
      "        └── [4.0K]  \u001b[01;34mexperiments\u001b[00m\n",
      "            └── [4.0K]  \u001b[01;34mgenerate_cohorts_for_emma\u001b[00m\n",
      "                ├── [ 48M]  sim2_sd.RData\n",
      "                └── [ 27M]  sim_2sd.txt\n",
      "\n",
      "6 directories, 5 files\n"
     ]
    }
   ],
   "source": [
    "!tree -h ./data/dropbox/Dave\\ Liu\\ Lab"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "16e112e7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>sim.tumor.1</th>\n",
       "      <th>sim.tumor.2</th>\n",
       "      <th>sim.tumor.3</th>\n",
       "      <th>sim.tumor.4</th>\n",
       "      <th>sim.tumor.5</th>\n",
       "      <th>sim.tumor.6</th>\n",
       "      <th>sim.tumor.7</th>\n",
       "      <th>sim.tumor.8</th>\n",
       "      <th>sim.tumor.9</th>\n",
       "      <th>sim.tumor.10</th>\n",
       "      <th>...</th>\n",
       "      <th>sim.tumor.91</th>\n",
       "      <th>sim.tumor.92</th>\n",
       "      <th>sim.tumor.93</th>\n",
       "      <th>sim.tumor.94</th>\n",
       "      <th>sim.tumor.95</th>\n",
       "      <th>sim.tumor.96</th>\n",
       "      <th>sim.tumor.97</th>\n",
       "      <th>sim.tumor.98</th>\n",
       "      <th>sim.tumor.99</th>\n",
       "      <th>sim.tumor.100</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>C9orf152</th>\n",
       "      <td>0.028776</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.005772</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.031280</td>\n",
       "      <td>0.002914</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.088944</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.117904</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RPS11</th>\n",
       "      <td>2478.085307</td>\n",
       "      <td>1045.414462</td>\n",
       "      <td>2758.862436</td>\n",
       "      <td>2057.947049</td>\n",
       "      <td>4070.987078</td>\n",
       "      <td>1659.456798</td>\n",
       "      <td>2859.195658</td>\n",
       "      <td>1065.899240</td>\n",
       "      <td>2349.481761</td>\n",
       "      <td>2637.818128</td>\n",
       "      <td>...</td>\n",
       "      <td>4776.934208</td>\n",
       "      <td>2408.690319</td>\n",
       "      <td>1859.773892</td>\n",
       "      <td>4281.505385</td>\n",
       "      <td>2551.071533</td>\n",
       "      <td>3110.260058</td>\n",
       "      <td>1344.174870</td>\n",
       "      <td>1366.332115</td>\n",
       "      <td>998.919522</td>\n",
       "      <td>3986.260110</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ELMO2</th>\n",
       "      <td>25.816809</td>\n",
       "      <td>51.613067</td>\n",
       "      <td>1.364861</td>\n",
       "      <td>49.631499</td>\n",
       "      <td>23.766269</td>\n",
       "      <td>79.361797</td>\n",
       "      <td>14.022186</td>\n",
       "      <td>7.872305</td>\n",
       "      <td>19.288029</td>\n",
       "      <td>13.010421</td>\n",
       "      <td>...</td>\n",
       "      <td>13.396117</td>\n",
       "      <td>35.758147</td>\n",
       "      <td>46.088149</td>\n",
       "      <td>12.032278</td>\n",
       "      <td>3.434030</td>\n",
       "      <td>0.822609</td>\n",
       "      <td>53.420241</td>\n",
       "      <td>7.413036</td>\n",
       "      <td>14.892599</td>\n",
       "      <td>6.852092</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CREB3L1</th>\n",
       "      <td>0.725366</td>\n",
       "      <td>7.867851</td>\n",
       "      <td>1.252144</td>\n",
       "      <td>0.474682</td>\n",
       "      <td>8.762088</td>\n",
       "      <td>10.596858</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.655449</td>\n",
       "      <td>...</td>\n",
       "      <td>3.202425</td>\n",
       "      <td>0.779560</td>\n",
       "      <td>3.776393</td>\n",
       "      <td>0.379870</td>\n",
       "      <td>0.506578</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.378280</td>\n",
       "      <td>0.101756</td>\n",
       "      <td>1.260692</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PNMA1</th>\n",
       "      <td>41.406801</td>\n",
       "      <td>48.818204</td>\n",
       "      <td>8.729317</td>\n",
       "      <td>7.881631</td>\n",
       "      <td>14.459906</td>\n",
       "      <td>34.883525</td>\n",
       "      <td>46.708295</td>\n",
       "      <td>22.368166</td>\n",
       "      <td>36.991187</td>\n",
       "      <td>91.032598</td>\n",
       "      <td>...</td>\n",
       "      <td>9.272580</td>\n",
       "      <td>121.571065</td>\n",
       "      <td>32.020835</td>\n",
       "      <td>2.484545</td>\n",
       "      <td>29.783628</td>\n",
       "      <td>5.378085</td>\n",
       "      <td>30.629469</td>\n",
       "      <td>17.332989</td>\n",
       "      <td>28.831176</td>\n",
       "      <td>6.627644</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PIK3IP1</th>\n",
       "      <td>132.135475</td>\n",
       "      <td>123.802270</td>\n",
       "      <td>13.047599</td>\n",
       "      <td>174.526768</td>\n",
       "      <td>100.507863</td>\n",
       "      <td>60.180157</td>\n",
       "      <td>76.263696</td>\n",
       "      <td>27.047873</td>\n",
       "      <td>253.063542</td>\n",
       "      <td>47.537680</td>\n",
       "      <td>...</td>\n",
       "      <td>131.571888</td>\n",
       "      <td>18.378600</td>\n",
       "      <td>344.247482</td>\n",
       "      <td>127.666994</td>\n",
       "      <td>12.920604</td>\n",
       "      <td>76.507566</td>\n",
       "      <td>156.687566</td>\n",
       "      <td>82.231383</td>\n",
       "      <td>75.808031</td>\n",
       "      <td>126.801974</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SNRPD2</th>\n",
       "      <td>268.061570</td>\n",
       "      <td>324.894879</td>\n",
       "      <td>662.050995</td>\n",
       "      <td>384.309295</td>\n",
       "      <td>488.325756</td>\n",
       "      <td>670.799164</td>\n",
       "      <td>223.992388</td>\n",
       "      <td>432.474139</td>\n",
       "      <td>279.580875</td>\n",
       "      <td>269.200471</td>\n",
       "      <td>...</td>\n",
       "      <td>567.251730</td>\n",
       "      <td>266.842777</td>\n",
       "      <td>497.765153</td>\n",
       "      <td>709.503904</td>\n",
       "      <td>533.440498</td>\n",
       "      <td>415.331437</td>\n",
       "      <td>126.172209</td>\n",
       "      <td>294.067533</td>\n",
       "      <td>544.736151</td>\n",
       "      <td>827.779813</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SLC39A6</th>\n",
       "      <td>66.076506</td>\n",
       "      <td>153.648357</td>\n",
       "      <td>2.529820</td>\n",
       "      <td>44.652424</td>\n",
       "      <td>17.833973</td>\n",
       "      <td>42.035755</td>\n",
       "      <td>185.820655</td>\n",
       "      <td>197.874939</td>\n",
       "      <td>159.224751</td>\n",
       "      <td>56.940459</td>\n",
       "      <td>...</td>\n",
       "      <td>141.092567</td>\n",
       "      <td>76.150471</td>\n",
       "      <td>83.955370</td>\n",
       "      <td>47.253105</td>\n",
       "      <td>7.051982</td>\n",
       "      <td>3.507683</td>\n",
       "      <td>173.370366</td>\n",
       "      <td>54.428770</td>\n",
       "      <td>90.296779</td>\n",
       "      <td>73.594054</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CTSC</th>\n",
       "      <td>71.864485</td>\n",
       "      <td>127.733518</td>\n",
       "      <td>38.049821</td>\n",
       "      <td>74.240185</td>\n",
       "      <td>107.772457</td>\n",
       "      <td>89.318134</td>\n",
       "      <td>85.454239</td>\n",
       "      <td>50.832309</td>\n",
       "      <td>193.924380</td>\n",
       "      <td>168.365208</td>\n",
       "      <td>...</td>\n",
       "      <td>91.602337</td>\n",
       "      <td>34.730985</td>\n",
       "      <td>172.097131</td>\n",
       "      <td>127.347545</td>\n",
       "      <td>71.869670</td>\n",
       "      <td>133.798294</td>\n",
       "      <td>93.338910</td>\n",
       "      <td>202.463807</td>\n",
       "      <td>101.346735</td>\n",
       "      <td>133.541503</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>AQP7</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.095607</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.497805</td>\n",
       "      <td>5.852436</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.869045</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.106912</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>23677 rows × 100 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          sim.tumor.1  sim.tumor.2  sim.tumor.3  sim.tumor.4  sim.tumor.5  \\\n",
       "C9orf152     0.028776     0.000000     0.000000     0.000000     0.005772   \n",
       "RPS11     2478.085307  1045.414462  2758.862436  2057.947049  4070.987078   \n",
       "ELMO2       25.816809    51.613067     1.364861    49.631499    23.766269   \n",
       "CREB3L1      0.725366     7.867851     1.252144     0.474682     8.762088   \n",
       "PNMA1       41.406801    48.818204     8.729317     7.881631    14.459906   \n",
       "...               ...          ...          ...          ...          ...   \n",
       "PIK3IP1    132.135475   123.802270    13.047599   174.526768   100.507863   \n",
       "SNRPD2     268.061570   324.894879   662.050995   384.309295   488.325756   \n",
       "SLC39A6     66.076506   153.648357     2.529820    44.652424    17.833973   \n",
       "CTSC        71.864485   127.733518    38.049821    74.240185   107.772457   \n",
       "AQP7         0.000000     0.000000     2.095607     0.000000     0.497805   \n",
       "\n",
       "          sim.tumor.6  sim.tumor.7  sim.tumor.8  sim.tumor.9  sim.tumor.10  \\\n",
       "C9orf152     0.000000     0.000000     0.000000     0.000000      0.000000   \n",
       "RPS11     1659.456798  2859.195658  1065.899240  2349.481761   2637.818128   \n",
       "ELMO2       79.361797    14.022186     7.872305    19.288029     13.010421   \n",
       "CREB3L1     10.596858     0.000000     0.000000     0.000000      2.655449   \n",
       "PNMA1       34.883525    46.708295    22.368166    36.991187     91.032598   \n",
       "...               ...          ...          ...          ...           ...   \n",
       "PIK3IP1     60.180157    76.263696    27.047873   253.063542     47.537680   \n",
       "SNRPD2     670.799164   223.992388   432.474139   279.580875    269.200471   \n",
       "SLC39A6     42.035755   185.820655   197.874939   159.224751     56.940459   \n",
       "CTSC        89.318134    85.454239    50.832309   193.924380    168.365208   \n",
       "AQP7         5.852436     0.000000     0.000000     0.869045      0.000000   \n",
       "\n",
       "          ...  sim.tumor.91  sim.tumor.92  sim.tumor.93  sim.tumor.94  \\\n",
       "C9orf152  ...      0.031280      0.002914      0.000000      0.000000   \n",
       "RPS11     ...   4776.934208   2408.690319   1859.773892   4281.505385   \n",
       "ELMO2     ...     13.396117     35.758147     46.088149     12.032278   \n",
       "CREB3L1   ...      3.202425      0.779560      3.776393      0.379870   \n",
       "PNMA1     ...      9.272580    121.571065     32.020835      2.484545   \n",
       "...       ...           ...           ...           ...           ...   \n",
       "PIK3IP1   ...    131.571888     18.378600    344.247482    127.666994   \n",
       "SNRPD2    ...    567.251730    266.842777    497.765153    709.503904   \n",
       "SLC39A6   ...    141.092567     76.150471     83.955370     47.253105   \n",
       "CTSC      ...     91.602337     34.730985    172.097131    127.347545   \n",
       "AQP7      ...      0.000000      0.000000      0.000000      0.000000   \n",
       "\n",
       "          sim.tumor.95  sim.tumor.96  sim.tumor.97  sim.tumor.98  \\\n",
       "C9orf152      0.000000      0.088944      0.000000      0.000000   \n",
       "RPS11      2551.071533   3110.260058   1344.174870   1366.332115   \n",
       "ELMO2         3.434030      0.822609     53.420241      7.413036   \n",
       "CREB3L1       0.506578      0.000000      0.378280      0.101756   \n",
       "PNMA1        29.783628      5.378085     30.629469     17.332989   \n",
       "...                ...           ...           ...           ...   \n",
       "PIK3IP1      12.920604     76.507566    156.687566     82.231383   \n",
       "SNRPD2      533.440498    415.331437    126.172209    294.067533   \n",
       "SLC39A6       7.051982      3.507683    173.370366     54.428770   \n",
       "CTSC         71.869670    133.798294     93.338910    202.463807   \n",
       "AQP7          0.000000      0.106912      0.000000      0.000000   \n",
       "\n",
       "          sim.tumor.99  sim.tumor.100  \n",
       "C9orf152      0.000000       0.117904  \n",
       "RPS11       998.919522    3986.260110  \n",
       "ELMO2        14.892599       6.852092  \n",
       "CREB3L1       1.260692       0.000000  \n",
       "PNMA1        28.831176       6.627644  \n",
       "...                ...            ...  \n",
       "PIK3IP1      75.808031     126.801974  \n",
       "SNRPD2      544.736151     827.779813  \n",
       "SLC39A6      90.296779      73.594054  \n",
       "CTSC        101.346735     133.541503  \n",
       "AQP7          0.000000       0.000000  \n",
       "\n",
       "[23677 rows x 100 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_sim_2sd = pd.read_csv(\n",
    "    './data/dropbox/Dave Liu Lab/Derek/simulations/experiments/generate_cohorts_for_emma/sim_2sd.txt',\n",
    "    sep='\\t',\n",
    ")\n",
    "\n",
    "df_sim_2sd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "027be080",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "environment": {
   "name": "tf2-gpu.2-5.m71",
   "type": "gcloud",
   "uri": "gcr.io/deeplearning-platform-release/tf2-gpu.2-5:m71"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
